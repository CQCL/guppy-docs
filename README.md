# Guppy Documentation

This repository contains documentation for the Guppy programming language.

## Contents
* The Guppy language guide
* The Guppy landing page
* The API documentation for the guppylang package
* FAQs, changelog and migration guides
* The guppylang [example notebooks](https://github.com/CQCL/guppylang/tree/main/examples) (included via the guppylang submodule)

The Sphinx docs are written in MyST markdown and rendered with the [myst-nb](https://myst-nb.readthedocs.io/en/latest/) library. This variant of markdown supports code cells which are executed at docs build time. See the section on [text-based notebooks](https://myst-nb.readthedocs.io/en/latest/authoring/basics.html#text-based-notebooks). The docs are styled with the [quantinuum-sphinx](https://github.com/CQCL/quantinuum-sphinx) theme.

For information on how the landing page is built, see the [landing page README](https://github.com/CQCL/guppy-docs/blob/main/landing/README.md).

## Updating the docs for a new Guppy release

1. Update the `pyproject.toml` in this repository, run `uv sync` to update `uv.lock`.
2. Run `just coverage` to check the API docs coverage. Document any undocumented classes or functions. 
3. Bump the `guppylang` submodule in this repository to the latest release tag (this submodule is only used for example notebooks and changelog).
4. Create a release from this repository. The docs website will deploy the content corresponding to the latest release tag from this repository.

## Testing in C.I.

The following checks are run when a pull request is opened.

* Spell checking - spell checking is done using the [typos crate](https://github.com/crate-ci/typos).
* The sphinx docs build is tested. This includes all code snippets and example notebooks. If a code snippet throws an error, this will fail the docs build.
* Link checking (using the [sphinx-linkcheck builder](https://www.sphinx-doc.org/en/master/usage/configuration.html#options-for-the-linkcheck-builder)) - All links in the `sphinx` directory are tested. Broken links will cause the C.I. checks to fail.
* (currently disabled) Sphinx coverage checks using [sphinx.ext.coverage](https://www.sphinx-doc.org/en/master/usage/extensions/coverage.html) - check that all of the public guppylang API is documented.

## Building the docs locally

Requirements:
* The [just command runner](https://github.com/casey/just) 
* Sphinx docs -> [uv](https://docs.astral.sh/uv/getting-started/installation/)
* Landing page -> [Node and npm](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm/)

See the `devenv.nix` file.

First clone the repository making sure to checkout the [guppylang](https://github.com/CQCL/guppylang) submodule.

```shell
git clone git@github.com:CQCL/guppy-docs.git --recurse-submodules
```

Alternatively you can update the submodules if you have already cloned the repository.

```shell
git submodule update --init
```
Next run the build with `just build`. This builds both the Sphinx docs and the landing page

```shell
just build
```

The built html page can be served locally with:

```shell
just serve
```

To clean all of the files generated by the sphinx build:

```shell
just cleanup
```

To run the build in "debug" mode:

```shell
just build-debug
```

Followed by

```shell
just serve-debug
```

Building the docs in debug mode with `just build-debug` allows sphinx warnings whereas `just build` treats these warnings as errors. Debug mode is useful for debugging issues with the executed Guppy code in the docs.

To check the API docs coverage run:

```shell
just coverage
```

To check all of the links in the Sphinx docs run:

```shell
just link-check
```
